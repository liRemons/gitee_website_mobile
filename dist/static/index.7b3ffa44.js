var e=Object.assign;import{j as o,y as t,M as a,p as n,a as l,g as r,r as s,o as c,c as i,b as d,R as u,F as p,N as h,w as m,A as v,G as f}from"./vendor.e50b7847.js";import{I as g}from"./index.60d1cd9e.js";const T={name:"Catalog",props:{list:Array,activeIndex:Number},setup(){const{proxy:n}=r(),l=o({value:"",inputFlag:!1});t((()=>{n.$nextTick((()=>{let e=document.querySelector(".menu"),o=document.querySelector(".menu .active");o&&Number(o.offsetTop)>window.innerHeight-150&&(e.scrollTop=Number(o.offsetTop)-100)}))}));return e(e({close:()=>{n.$emit("close")}},a(l)),{onCancel:()=>{n.$emit("search",""),l.value="",l.inputFlag=!1},handle:e=>{n.$emit("scrollTo",e)}})}},C=m("data-v-5602f137");n("data-v-5602f137");const w={class:"bg"},L={key:0,action:"/"},x={class:"main menu"};l();const y=C(((e,o,t,a,n,l)=>{const r=s("van-icon"),m=s("van-nav-bar"),v=s("van-search");return c(),i("div",w,[d(m,{title:"目录","left-arrow":"/"!==e.$route.path,onClickLeft:a.close},{right:C((()=>["/"!==e.$route.path?(c(),i(r,{key:0,onClick:o[1]||(o[1]=o=>e.inputFlag=!0),name:"search",size:"20"})):u("",!0)])),_:1},8,["left-arrow","onClickLeft"]),e.inputFlag?(c(),i("form",L,[d(v,{modelValue:e.value,"onUpdate:modelValue":o[2]||(o[2]=o=>e.value=o),"show-action":"",shape:"round",background:"transparent",placeholder:"请输入搜索关键词",onSearch:o[3]||(o[3]=o=>e.$emit("search",e.value)),onCancel:a.onCancel},null,8,["modelValue","onCancel"])])):u("",!0),d("div",x,[(c(!0),i(p,null,h(t.list,((e,o)=>(c(),i("div",{class:{active:o===t.activeIndex},innerHTML:e.outerHTML,key:e.outerHTML,onClick:e=>a.handle(o)},null,10,["innerHTML","onClick"])))),128))])])}));T.render=y,T.__scopeId="data-v-5602f137";const k={components:{Catalog:T},setup(){const{proxy:n}=r(),l=o({html:"",code:n.$route.query.id,authorList:[],activeIndex:0,showCatalog:!1});v((()=>n.$route),((e,o)=>{list=[],l.code=e.query.id,l.authorList=[],n.$nextTick((()=>{l.code&&c()}))})),t((()=>{c()}));const s=()=>{let e=[];document.querySelectorAll(".md .md-header-anchor").forEach((o=>{"H2"!==o.parentNode.nodeName&&e.push({outerHTML:o.parentNode.outerHTML,innerText:o.parentNode.innerText,nodeName:o.parentNode.nodeName,offsetTop:o.parentNode.offsetTop,classActive:!1})})),l.authorList=e},c=async()=>{let e=await n.$api.HOME.getFileOption(l.code);l.html=e,setTimeout((()=>{s()}),1e3)};return e(e({},a(l)),{scrollTo:e=>{let o=document.querySelector(".main");l.activeIndex=e,o.scrollTop=l.authorList[e].offsetTop-100},handleCatalog:()=>{let e=document.querySelector(".main").scrollTop||document.documentElement.scrollTop;l.activeIndex=l.authorList.findIndex((o=>o.offsetTop>e)),l.showCatalog=!0},proview:e=>{"IMG"===e.target.nodeName&&g([e.target.currentSrc])},search:e=>{s(),e&&(l.authorList=l.authorList.filter((o=>o.innerText.includes(e))),0===l.authorList.length&&s())}})}},b=m("data-v-10b9fd12");n("data-v-10b9fd12");const H={class:"flex"},I=f(" 回首页 ");l();const N=b(((e,o,t,a,n,l)=>{const r=s("van-button"),p=s("van-empty"),h=s("LeftBtn"),m=s("Catalog"),v=s("van-popup");return c(),i("div",H,[e.html?u("",!0):(c(),i(p,{key:0,description:"开发中..."},{default:b((()=>[d(r,{round:"",class:"bottom-button",onClick:o[1]||(o[1]=o=>e.$router.replace("/"))},{default:b((()=>[I])),_:1})])),_:1})),d("div",{class:"md",innerHTML:e.html,onClick:o[2]||(o[2]=(...e)=>a.proview&&a.proview(...e))},null,8,["innerHTML"]),d(h,{onHandleCatalog:a.handleCatalog},null,8,["onHandleCatalog"]),d(v,{show:e.showCatalog,"onUpdate:show":o[4]||(o[4]=o=>e.showCatalog=o),position:"right",style:{height:"100%",width:"80%"},"lock-scroll":!1},{default:b((()=>[e.showCatalog?(c(),i(m,{key:0,onClose:o[3]||(o[3]=o=>e.showCatalog=!1),onScrollTo:a.scrollTo,onSearch:a.search,list:e.authorList,activeIndex:e.activeIndex},null,8,["onScrollTo","onSearch","list","activeIndex"])):u("",!0)])),_:1},8,["show"])])}));k.render=N,k.__scopeId="data-v-10b9fd12";export default k;
