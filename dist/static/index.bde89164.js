var e=Object.assign;import{a as t,j as o,C as a,A as l,B as n,D as r,E as c,G as s,k as i,R as d,F as u,H as h,g as p,I as m,w as v,s as g}from"./vendor.a50f5807.js";import{I as f}from"./index.235240a3.js";const x={name:"Catalog",props:{list:Array},setup(){const{proxy:l}=p(),n=t({value:"",inputFlag:!1});o((()=>{let e=document.querySelector(".active");e&&e.scrollIntoView({behavior:"smooth"})}));return e(e({close:()=>{l.$emit("close")}},a(n)),{onCancel:()=>{l.$emit("search",""),n.value="",n.inputFlag=!1},handle:(e,t)=>{l.$emit("scrollTo",{index:e,activeIndex:t})}})}},y=m("data-v-650560f3");l("data-v-650560f3");const C={class:"child_bg"},w={key:0,action:"/"},T={class:"main menu"};n();const L=y(((e,t,o,a,l,n)=>{const p=r("van-icon"),m=r("van-nav-bar"),v=r("van-search");return c(),s("div",C,[i(m,{title:"目录","left-arrow":"/"!==e.$route.path,onClickLeft:a.close},{right:y((()=>["/"!==e.$route.path?(c(),s(p,{key:0,onClick:t[1]||(t[1]=t=>e.inputFlag=!0),name:"search",size:"20"})):d("",!0)])),_:1},8,["left-arrow","onClickLeft"]),e.inputFlag?(c(),s("form",w,[i(v,{modelValue:e.value,"onUpdate:modelValue":t[2]||(t[2]=t=>e.value=t),"show-action":"",shape:"round",background:"transparent",placeholder:"请输入搜索关键词",onSearch:t[3]||(t[3]=t=>e.$emit("search",e.value)),onCancel:a.onCancel},null,8,["modelValue","onCancel"])])):d("",!0),i("div",T,[(c(!0),s(u,null,h(o.list,((t,o)=>(c(),s("div",{class:{active:o==e.$route.query.index},innerHTML:t.outerHTML,key:t.outerHTML,onClick:e=>a.handle(t.index,o)},null,10,["innerHTML","onClick"])))),128))])])}));x.render=L,x.__scopeId="data-v-650560f3";const $={components:{Catalog:x},setup(){const{proxy:l}=p(),n=t({html:"",code:l.$route.query.id,authorList:[],activeIndex:0,showCatalog:!1,topFlag:!1,watchScrollFlag:!0});v((()=>l.$route),((e,t)=>{n.code=e.query.id,l.$nextTick((()=>{t.query.id!==n.code&&n.code&&c()}))})),o((()=>{c();let e=document.querySelector(".main");l.$utils.watchScroll(d,500,e)}));const r=()=>{let e=[],t=document.querySelectorAll(".md .md-header-anchor");t.forEach(((o,a)=>{if("H2"!==o.parentNode.nodeName||1===t.length){const{innerText:t,nodeName:l,offsetTop:n,outerHTML:r}=o.parentNode;e.push({outerHTML:r.replace(/<a.*?>([\s\S]*)<\/a>/,""),innerText:t,nodeName:l,offsetTop:n,classActive:!1,index:a})}})),n.authorList=e},c=async()=>{let e=await l.$api.HOME.getFileOption(n.code);n.html=e,l.$nextTick((()=>{r(),[...document.querySelectorAll("#write a")].filter((e=>e.outerHTML.includes("#"))).forEach((e=>{e.onclick=e=>{let t=n.authorList.findIndex((t=>decodeURIComponent(e.target.parentNode.hash).replace("#","")===t.innerText));return t>=0&&i(t),!1}})),l.$route.query.index&&i(l.$route.query.index),document.querySelectorAll(".md-fences").forEach((e=>{let t=document.createElement("div");t.setAttribute("class","copy_code"),e.appendChild(t)}))}))},s=e=>{const{$route:t}=l;l.$router.replace({path:t.path,query:{title:t.query.title,id:t.query.id,index:e}})},i=e=>{let t,o,a;isNaN(e)?(t=e.activeIndex,e=e.index,o=n.authorList[t].innerText):o=n.authorList[e].innerText,n.watchScrollFlag=!1,document.querySelectorAll(".md-header-anchor").forEach((e=>{e.parentNode.innerText===o&&(a=e)})),a&&(a.scrollIntoView({behavior:"smooth"}),n.activeIndex=void 0!==t?t:e,s(n.activeIndex))},d=()=>{if(!n.watchScrollFlag)return void(n.watchScrollFlag=!0);let e=document.querySelector(".main").scrollTop||document.documentElement.scrollTop;n.topFlag=e>=400,n.activeIndex=Math.max(...n.authorList.map(((t,o)=>{if(e>=t.offsetTop)return o})).filter((e=>void 0!==e))),n.activeIndex>=0&&s(n.activeIndex)};return e(e({},a(n)),{scrollTo:i,handleCatalog:()=>{r(),n.showCatalog=!0},proview:e=>{if("copy_code"===e.target.className)return l.$utils.copy(e.target.parentElement),void l.$toast.success("复制成功");"IMG"===e.target.nodeName&&f([e.target.currentSrc])},search:e=>{r(),e&&(n.authorList=n.authorList.filter((t=>t.innerText.toLowerCase().includes(e.toLowerCase()))),0===n.authorList.length&&r())}})}},S=m("data-v-0b126604");l("data-v-0b126604");const k={class:"flex"},I=g(" 回首页 ");n();const q=S(((e,t,o,a,l,n)=>{const u=r("van-button"),h=r("van-empty"),p=r("LeftBtn"),m=r("Catalog"),v=r("van-popup");return c(),s("div",k,[e.html?d("",!0):(c(),s(h,{key:0,description:"开发中..."},{default:S((()=>[i(u,{round:"",class:"bottom-button",onClick:t[1]||(t[1]=t=>e.$router.replace("/"))},{default:S((()=>[I])),_:1})])),_:1})),i("div",{class:"md",innerHTML:e.html,onClick:t[2]||(t[2]=(...e)=>a.proview&&a.proview(...e))},null,8,["innerHTML"]),i(p,{topFlag:e.topFlag,onHandleCatalog:a.handleCatalog},null,8,["topFlag","onHandleCatalog"]),e.showCatalog?(c(),s(v,{key:1,show:e.showCatalog,"onUpdate:show":t[4]||(t[4]=t=>e.showCatalog=t),position:"right",teleport:".bg",style:{height:"100%",width:"80%"},"lock-scroll":!1},{default:S((()=>[i(m,{onClose:t[3]||(t[3]=t=>e.showCatalog=!1),onScrollTo:a.scrollTo,onSearch:a.search,list:e.authorList},null,8,["onScrollTo","onSearch","list"])])),_:1},8,["show"])):d("",!0)])}));$.render=q,$.__scopeId="data-v-0b126604";export default $;
